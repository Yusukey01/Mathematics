<!DOCTYPE html>
<html>
    <head> 
        <title>Least-Squares</title>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </head>
    <body> 
        <h1>Least-Squares Problems</h1>
        <blockquote>
            If \(A \in \mathbb{R}^{m \times n}\) and \(b \in \mathbb{R}^m\), a <strong>least-squares solution</strong> of
            \(Ax = b\) is an \(\hat{x} \in \mathbb{R}^n\) s.t.
            \[\forall x \in \mathbb{R}^n, \quad \| b - A\hat{x} \| \leq \| b - Ax \|. \]
            We call the norm \(\| b - A\hat{x} \| \) the <strong>least-squares error</strong> of the approximation. 
            <br><br>
            In practice, it is possible that a solution of some problem \(Ax = b\) is required but it does not exist
            (= the system is inconsistent). In that case, we try to find an \(x\) that makes \(Ax\) close to \(b\) 
            as much as possible. Let 
            \[\hat{b} = \text{proj}_{\text{Col }A} \, b \]
            Since \(\hat{b} \in \text{Col }A \,\), \(Ax = \hat{b}\) is consistent. 
            This \(\hat{b}\) is the closest point to \(b\) in \(\text{Col }A\).
            Then, there exists a least-squares solution \(\hat{x} \in \mathbb{R}^n\) s.t. \(A\hat{x} = \hat{b}\).
            <br><br>
            Since \(\hat{b}\) is orthogonal to \(b\), we can say that \(b - \hat{b} = b - A\hat{x}\) is orthognal 
            to \(\text{Col }A\). (Note:\(b = A\hat{x} + (b - A\hat{x})\))
            <br>Let \(a_j\) be a column of \(A\), then 
             \[a_j \cdot (b-A\hat{x}) = 0 \Longrightarrow a_j^T(b-A\hat{x}) = 0 \Longrightarrow A^T (b-A\hat{x}) = 0 \]
            and we obtain 
            \[A^TA\hat{x} = A^Tb\]
            So, the set of least-squares solutions of \(Ax =b\) must satisfy the <strong>normal equations</strong>
            \[A^TAx = A^Tb\]
            <br>
            If \(A^TA\) is invertible(= The columns of \(A\) are <strong>linearly independent</strong>.),
            \[\hat{x} = (A^TA)^{-1}A^Tb\]
            In practice, computing \(A^TA\) makes relatively large errors in \(\hat{x}\). The <strong>QR factorization</strong>,
            gives us more reliable result. Let \(A = QR\), 
            \[\hat{x} = (R^TQ^TQR)^{-1}(R^TQ^T)b = (R^TR)^{-1}(R^TQ^T)b  \tag{1}\]
            On the other hand, 
            \[A\hat{x} = b \Longrightarrow Q^TQR\hat{x} = Q^Tb \Longrightarrow  R\hat{x} = Q^Tb \Longrightarrow \hat{x} = R^{-1}Q^Tb \]
            Comparing with (1), \((R^TR)^{-1}R^T = R^{-1}\). 
            Thus, the unique least-squares solution can be generated by \(\hat{x} = R^{-1}Q^Tb\) but in practice, solving 
            \[R\hat{x} = Q^Tb\]
            by back-substitution is much faster than computing \(R^{-1}\).


        </blockquote>

        <h1>XXX</h1>
        <blockquote>
        </blockquote>

        <h1>XXX</h1>
        <blockquote>
        </blockquote>


        <a href="index.html">Back to Home </a>
        <br> <a href="linear_algebra.html">Back to Linear Algebra </a>
    </body>
</html>